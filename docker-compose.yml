version: '3.7'

services:
  control:
    image: ansible_controller
    container_name: con
    working_dir: "/home/ansible"

    volumes:
      - /c/Users/Public/repos/ansible:/home/ansible/code
      - /c/Users/Public/docker-shared:/tmp/shared
    tty: true # Can keep running

  jenkins:
    image: ymktk/centos-systemd:openjdk-11
    container_name: jk
    working_dir: "/tmp"
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
      - /c/Users/Public/docker-shared/downloads:/var/tmp/downloads/jenkins-2.204.5
      - /c/Users/Public/docker-shared:/tmp/shared
    ports:
      - "8082:8082"
    privileged: true

  app:
    image: ymktk/centos-systemd:tomcat-9.0
    container_name: app
    working_dir: "/opt"
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
      - /c/Users/Public/docker-shared/downloads:/var/tmp/downloads
    ports:
      - "8090:8090"
      - "8091:8091"
      - "8092:8092"
    privileged: true

  db:
    image: "mcr.microsoft.com/mssql/server:2017-latest"
    container_name: mssql
    environment:
      - ACCEPT_EULA=Y
      - SA_PASSWORD=sa@Password
    # volumes:
      # - /c/Users/Public/docker-shared/data-mssql:/tmp/shared
    ports:
      - "1433:1433"
